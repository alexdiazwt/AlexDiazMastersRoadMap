<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WTAMU Academic Mission Control</title>
    <!-- Tailwind for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide for icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        [x-cloak] { display: none !important; }
        .wtamu-maroon { background-color: #800000; }
        .text-wtamu-maroon { color: #800000; }
        /* Custom scrollbar for a cleaner look */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 10px; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 font-sans antialiased pb-20" x-data="academicApp">

    <!-- Header / Progress Bar -->
    <header class="wtamu-maroon text-white pt-12 pb-24 px-6 relative overflow-hidden">
        <div class="max-w-4xl mx-auto relative z-10">
            <div class="flex justify-between items-center mb-6">
                <span class="text-[10px] font-black uppercase tracking-[0.3em] border border-white/30 px-3 py-1 rounded-full">MS-CISBA Master Plan</span>
                <span class="text-xs opacity-70" x-text="completed.length + ' / ' + courses.length + ' Courses Done'"></span>
            </div>
            <h1 class="text-4xl font-black tracking-tighter mb-2">Academic Mission Control</h1>
            <p class="text-red-100 font-light italic">Targeting Fall 2028 Graduation</p>
            
            <div class="mt-8 bg-black/20 p-5 rounded-3xl backdrop-blur-md border border-white/10">
                <div class="flex justify-between text-[10px] font-bold uppercase mb-2">
                    <span>Degree Completion</span>
                    <span x-text="Math.round(progress) + '%'"></span>
                </div>
                <div class="h-3 bg-white/10 rounded-full overflow-hidden border border-white/5">
                    <div class="h-full bg-amber-400 transition-all duration-1000 ease-out shadow-[0_0_15px_rgba(251,191,36,0.5)]" 
                         :style="'width:' + progress + '%'"></div>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-6 -mt-12 space-y-8">
        <!-- Persistent Navigation -->
        <nav class="flex bg-white p-1.5 rounded-2xl shadow-2xl border border-slate-200 sticky top-4 z-50">
            <button @click="tab = 'roadmap'" 
                    :class="tab === 'roadmap' ? 'bg-[#800000] text-white shadow-lg' : 'text-slate-500 hover:bg-slate-50'" 
                    class="flex-1 py-3 rounded-xl text-xs font-black uppercase transition-all flex items-center justify-center gap-2">
                <i data-lucide="map" class="w-4 h-4"></i> Roadmap
            </button>
            <button @click="tab = 'advisor'" 
                    :class="tab === 'advisor' ? 'bg-[#800000] text-white shadow-lg' : 'text-slate-500 hover:bg-slate-50'" 
                    class="flex-1 py-3 rounded-xl text-xs font-black uppercase transition-all flex items-center justify-center gap-2">
                <i data-lucide="sparkles" class="w-4 h-4"></i> AI Advisor
            </button>
        </nav>

        <!-- ROADMAP VIEW -->
        <div x-show="tab === 'roadmap'" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-4">
            <div class="grid gap-4">
                <template x-for="course in courses" :key="course.id">
                    <div class="bg-white rounded-[2rem] p-5 shadow-sm border-2 flex items-center gap-4 transition-all hover:shadow-md" 
                         :class="isDone(course.id) ? 'border-green-400/30 bg-green-50/10' : 'border-transparent'">
                        
                        <div class="w-14 h-14 rounded-2xl flex items-center justify-center text-white shrink-0 shadow-inner" :class="course.colorClass">
                            <i :data-lucide="course.icon" class="w-7 h-7"></i>
                        </div>
                        
                        <div class="flex-1 min-w-0">
                            <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest" x-text="course.sem"></span>
                            <h3 class="font-bold text-slate-800 truncate" x-text="course.name"></h3>
                            <p class="text-xs text-slate-500 truncate" x-text="course.title"></p>
                        </div>

                        <div class="flex gap-2">
                            <!-- Toggle Completion -->
                            <button @click="toggleCourse(course.id)" 
                                    :class="isDone(course.id) ? 'bg-green-500 text-white' : 'bg-slate-100 text-slate-400 hover:bg-slate-200'" 
                                    class="w-10 h-10 rounded-xl flex items-center justify-center transition-all">
                                <i data-lucide="check" class="w-5 h-5"></i>
                            </button>
                            <!-- Quick AI Ask -->
                            <button @click="askGemini('Explain the core learning objectives of ' + course.name + ': ' + course.title)" 
                                    class="w-10 h-10 rounded-xl bg-blue-50 text-blue-600 hover:bg-blue-100 flex items-center justify-center transition-all">
                                <i data-lucide="help-circle" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>
                </template>
            </div>
        </div>

        <!-- ADVISOR VIEW -->
        <div x-show="tab === 'advisor'" x-cloak x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-4">
            <div class="space-y-6">
                <!-- AI Quick Actions -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <button @click="askGemini('Analyze my remaining courses and suggest a career path in data science or cybersecurity based on my WTAMU MS-CISBA plan.')" 
                            class="p-6 bg-indigo-600 rounded-3xl text-white text-left shadow-lg hover:bg-indigo-700 transition-colors group">
                        <i data-lucide="briefcase" class="mb-3 w-6 h-6 group-hover:scale-110 transition-transform"></i>
                        <h4 class="font-black uppercase text-[10px] tracking-widest">Career Strategy</h4>
                        <p class="text-[10px] opacity-70 mt-1 uppercase font-bold">Industry Alignment</p>
                    </button>
                    <button @click="askGemini('Create a study plan for my quantitative and data mining courses (CIDM 6305 and 6355) that helps me balance work and school.')" 
                            class="p-6 bg-teal-600 rounded-3xl text-white text-left shadow-lg hover:bg-teal-700 transition-colors group">
                        <i data-lucide="calendar" class="mb-3 w-6 h-6 group-hover:scale-110 transition-transform"></i>
                        <h4 class="font-black uppercase text-[10px] tracking-widest">Study Planner</h4>
                        <p class="text-[10px] opacity-70 mt-1 uppercase font-bold">Optimization</p>
                    </button>
                </div>

                <!-- Loading State -->
                <div x-show="loading" class="flex flex-col items-center justify-center p-12 bg-white rounded-[2.5rem] border border-dashed border-slate-300">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-[#800000] mb-4"></div>
                    <p class="text-xs font-black text-slate-400 uppercase tracking-widest">Gemini is analyzing your plan...</p>
                </div>

                <!-- Response Feed -->
                <div class="space-y-4">
                    <template x-for="note in notes" :key="note.id">
                        <div class="bg-white p-8 rounded-[2.5rem] border border-slate-200 shadow-sm relative overflow-hidden group">
                            <div class="absolute top-0 left-0 w-1 h-full bg-blue-500"></div>
                            <div class="flex justify-between items-start mb-4">
                                <span class="text-[10px] font-black text-blue-500 uppercase tracking-widest">AI Intelligence Report</span>
                                <button @click="deleteNote(note.id)" class="text-slate-300 hover:text-red-500 transition-colors">
                                    <i data-lucide="trash-2" class="w-4 h-4"></i>
                                </button>
                            </div>
                            <div class="prose prose-slate max-w-none text-sm leading-relaxed text-slate-600" x-html="note.content"></div>
                            <div class="mt-6 pt-4 border-t border-slate-50 text-[10px] text-slate-400 italic" x-text="'Generated on ' + note.date"></div>
                        </div>
                    </template>
                </div>

                <!-- Empty State -->
                <div x-show="notes.length === 0 && !loading" class="text-center py-20 opacity-30">
                    <i data-lucide="message-square" class="w-12 h-12 mx-auto mb-4"></i>
                    <p class="font-bold uppercase tracking-widest text-xs">No AI reports generated yet</p>
                </div>
            </div>
        </div>
    </main>

    <script>
        function setupApp() {
            document.addEventListener('alpine:init', () => {
                Alpine.data('academicApp', () => ({
                    tab: 'roadmap',
                    loading: false,
                    progress: 0,
                    completed: JSON.parse(localStorage.getItem('wtamu_completed') || '[]'),
                    notes: JSON.parse(localStorage.getItem('wtamu_notes') || '[]'),
                    
                    // Course data based on your 2-Year Hybrid Plan
                    courses: [
                        { id: '6305', name: 'CIDM 6305', title: 'Quantitative Analysis', sem: 'Spring 2026', icon: 'bar-chart-2', colorClass: 'bg-indigo-600' },
                        { id: '6350', name: 'CIDM 6350', title: 'Data & Info Management', sem: 'Fall 2026', icon: 'database', colorClass: 'bg-teal-600' },
                        { id: '5310', name: 'CIDM 5310', title: 'Business Intelligence & DSS', sem: 'Fall 2026', icon: 'layout', colorClass: 'bg-teal-600' },
                        { id: '6355', name: 'CIDM 6355', title: 'Data Mining Methods', sem: 'Spring 2027', icon: 'cpu', colorClass: 'bg-rose-700' },
                        { id: '6308', name: 'CIDM 6308', title: 'Seminar in Data/Analytics', sem: 'Spring 2027', icon: 'layers', colorClass: 'bg-rose-700' },
                        { id: '5380', name: 'CIDM 5380', title: 'Cloud Computing & Security', sem: 'Fall 2027', icon: 'cloud', colorClass: 'bg-slate-700' },
                        { id: '6341', name: 'CIDM 6341', title: 'Cyber Risk Management', sem: 'Fall 2027', icon: 'shield-alert', colorClass: 'bg-slate-700' },
                        { id: '6325', name: 'CIDM 6325', title: 'Web App Development', sem: 'Spring 2028', icon: 'code', colorClass: 'bg-amber-500' },
                        { id: '6390', name: 'CIDM 6390', title: 'Enterprise Project Mgmt', sem: 'Spring 2028', icon: 'briefcase', colorClass: 'bg-amber-500' },
                        { id: '6395', name: 'CIDM 6395', title: 'Capstone Artifact', sem: 'Fall 2028', icon: 'graduation-cap', colorClass: 'bg-red-700' }
                    ],

                    init() {
                        this.updateProgress();
                        this.$nextTick(() => lucide.createIcons());
                    },

                    isDone(id) { return this.completed.includes(id); },

                    toggleCourse(id) {
                        this.completed = this.isDone(id) 
                            ? this.completed.filter(i => i !== id) 
                            : [...this.completed, id];
                        localStorage.setItem('wtamu_completed', JSON.stringify(this.completed));
                        this.updateProgress();
                    },

                    updateProgress() {
                        this.progress = (this.completed.length / this.courses.length) * 100;
                    },

                    deleteNote(id) {
                        this.notes = this.notes.filter(n => n.id !== id);
                        localStorage.setItem('wtamu_notes', JSON.stringify(this.notes));
                    },

                    async askGemini(promptText) {
                        // --- PASTE YOUR API KEY BELOW ---
                        const apiKey = ""; 
                        
                        if (!apiKey) {
                            alert("AIzaSyCDWJdpseYGG-CdejpRv3JuiXtfBOeJk0o");
                            return;
                        }

                        this.tab = 'advisor';
                        this.loading = true;

                        try {
                            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    contents: [{ 
                                        parts: [{ text: promptText + ". Response should be professional, academic, and formatted in clean HTML without markdown backticks." }] 
                                    }]
                                })
                            });

                            const data = await response.json();
                            const resultText = data.candidates[0].content.parts[0].text;

                            this.notes.unshift({
                                id: Date.now(),
                                content: resultText,
                                date: new Date().toLocaleDateString() + ' ' + new Date().toLocaleTimeString()
                            });

                            localStorage.setItem('wtamu_notes', JSON.stringify(this.notes.slice(0, 15)));
                        } catch (error) {
                            console.error("Gemini Error:", error);
                            alert("Failed to reach Gemini. Check your API key or internet connection.");
                        } finally {
                            this.loading = false;
                            this.$nextTick(() => lucide.createIcons());
                        }
                    }
                }));
            });
        }
        setupApp();
    </script>
    <!-- Alpine.js script placed at the end to ensure registration happens before initialization -->
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
</body>
</html>